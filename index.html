<head>
  <title>Disneyland Today</title>
  <link href="styles.css" rel="stylesheet">
</head>

<body>
  <div class="container">
      <div class="left">Disneyland Hotel</div>
      <div class="middle">
        <div>
        <titleBlock>Welcome to Disneyland Resort!</titleBlock>
        <p>This is a replica page designed to reproduce and enhance the dashboard found on the TVs in the Disneyland Resort. Future plans for this page include:
          <br>- Live park updates (open/close times, wait times)
          <br>- Multiple options for UI layouts- including the pre and post 2023 designs
          <br>- Options for various music loops and themes
          <br>- Actually finishing the UI (i made this in 2 hours)
          <br>- And More!!! (potentially)
        </p>
      
      </div></div>
      <div class="right">
        <day>Thursday<br></day>
        <date>March 17<br></date>
        <time>12:57 AM<br></time>
        <br>

        <div class="weatherContainer">
          <div class="weatherElem">
            <span class="defGrey">
              Current
            </span>
            <span id="currentWeather">
            </span>
          </div>
            <div class="weatherElem">
              <span class="defGrey">
                Later
              </span>
              <span id="laterWeather">
                ??°
              </span>
        </div>

      </div>
  </div>

  <script>
    function updateClock() {
        const now = new Date();
        
        // Update time
        const hours = now.getHours();
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const seconds = String(now.getSeconds()).padStart(2, '0');
        const ampm = hours >= 12 ? 'PM' : 'AM';
        const hour12 = hours % 12 || 12;
        document.querySelector('time').textContent = `${hour12}:${minutes} ${ampm}`;

        // Update day
        const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        const dayName = days[now.getDay()];
        document.querySelector('day').textContent = `${dayName}`;

        // Update date
        const monthNames = [
            'January', 'February', 'March', 'April', 'May', 'June',
            'July', 'August', 'September', 'October', 'November', 'December'
        ];
        const monthName = monthNames[now.getMonth()];
        const day = now.getDate();
        document.querySelector('date').textContent = `${monthName} ${day}`;
    }

    setInterval(updateClock, 1000);
    updateClock();  // Initial call to display clock immediately

    const latitude = 33.84568;  // Latitude of Anaheim
    const longitude = -117.90953;  // Longitude of Anaheim

    async function getWeather() {
        try {
            // woo a free weather API
            const currentWeatherUrl = `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=temperature_2m,weathercode&timezone=America/Los_Angeles&lang=en`;
            const currentResponse = await fetch(currentWeatherUrl);
            const currentData = await currentResponse.json();
            console.log(currentData)
            const currentWeather = getWeatherDescription(currentData.current.weathercode);
            const currentTemp = Math.ceil(currentData.current.temperature_2m);
            console.log('Current Weather:', currentWeather);
            console.log('Current Temp:', currentTemp);

            document.getElementById("currentWeather").textContent = currentTemp+"°"

        } catch (error) {
            console.error('Error fetching weather data:', error);
        }
    }

    // went down a rabbit hole of WMO codes, theyre neat
    //TODO: add lil icons to show the weather state
    //TODO: add a "later" forecast section
    function getWeatherDescription(wmoCode) {
        switch (wmoCode) {
            case 1:
                return 'Clear sky';
            case 2:
                return 'Nearly clear sky';
            case 3:
                return 'Partly cloudy';
            case 4:
                return 'Cloudy sky';
            case 5:
                return 'Fog';
            case 10:
                return 'Rain showers';
            case 21:
                return 'Thunderstorm';
            default:
                return 'Unknown';
        }
    }

    getWeather();
</script>
</body>
</html>